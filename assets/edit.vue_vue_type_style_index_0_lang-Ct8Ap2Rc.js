import{d as A,r as d,ap as D,g as f,w as u,U as N,a7 as S,aq as B,n as v,e as l,J as F,Q as I,f as j,R as K,S as O,aa as T,a6 as J,ab as M,l as P,p as Q,ar as z,as as H,E as L}from"./index-BlNhG5G6.js";/* empty css                     *//* empty css               *//* empty css                    *//* empty css                 */const ae=A({__name:"edit",emits:["refresh"],setup(W,{expose:w,emit:_}){const n=d(!1),p=d(),g=d(),a=d({id:0,nickname:"",username:"",password:"",confirm_password:"",group_id:"",name:"",weight:0,remark:"",status:0}),c=d([]),V=async()=>{try{const{data:o}=await S(a.value.id);c.value=o||[]}catch(o){console.error("获取用户权限失败:",o)}},b=async o=>{try{const{data:e}=await B(o);return e}catch(e){console.error("获取用户权限失败:",e)}},k={label:"name",children:"children"},y=_,i=d({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!1,message:"请输入密码",trigger:"submit"},{min:6,message:"密码长度不能少于6位",trigger:"submit"}],confirm_password:[{required:!1,message:"请再次输入密码",trigger:"submit"},{validator:(o,e,s)=>{e!==a.value.password?s(new Error("两次密码输入不一致")):s()},trigger:"submit"}],group_id:[{required:!0,message:"请选择所属分组",trigger:"change"}]}),U=()=>{a.value.id===0?(i.value.password[0].required=!0,i.value.confirm_password[0].required=!0):(i.value.password[0].required=!1,i.value.confirm_password[0].required=!1)},E=async(o={})=>{const e={...o};if(e.group_id===0&&(e.group_id=""),Object.assign(a.value,e),await V(),e.id>0){const s=await b(e.id);Object.assign(a.value,s),a.value.password="",a.value.confirm_password=""}U(),n.value=!0},h=async()=>{var t,m;await((t=p.value)==null?void 0:t.validate());const o=((m=g.value)==null?void 0:m.getCheckedKeys(!0))||[],e={...a.value,rule_ids:o};e.id>0&&!a.value.password&&delete e.password,delete e.confirm_password;let s;e.id==0?s=await z(e):s=await H(e),s.status&&(L.success(s.message),y("refresh"),n.value=!1)},q=()=>{a.value={id:0,nickname:"",username:"",password:"",confirm_password:"",group_id:"",name:"",weight:0,remark:"",status:0}};return D(n,o=>{o||q()}),w({open:E}),(o,e)=>{const s=O,t=K,m=T,x=J,C=M,G=P,R=N;return v(),f(R,{modelValue:n.value,"onUpdate:modelValue":e[8]||(e[8]=r=>n.value=r),title:"用户分组",width:"40%"},{default:u(()=>[l(F(I),{model:a.value,"label-width":"100px",rules:i.value,ref_key:"formRef",ref:p},{default:u(()=>[l(t,{label:"用户名",prop:"username"},{default:u(()=>[l(s,{modelValue:a.value.username,"onUpdate:modelValue":e[0]||(e[0]=r=>a.value.username=r),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(t,{label:"密码",prop:"password"},{default:u(()=>[l(s,{modelValue:a.value.password,"onUpdate:modelValue":e[1]||(e[1]=r=>a.value.password=r),"show-password":"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),a.value.password?(v(),f(t,{key:0,label:"确认密码",prop:"confirm_password"},{default:u(()=>[l(s,{modelValue:a.value.confirm_password,"onUpdate:modelValue":e[2]||(e[2]=r=>a.value.confirm_password=r),"show-password":"",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1})):j("",!0),l(t,{label:"昵称",prop:"nickname"},{default:u(()=>[l(s,{modelValue:a.value.nickname,"onUpdate:modelValue":e[3]||(e[3]=r=>a.value.nickname=r),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1}),l(t,{label:"所属分组",prop:"group_id"},{default:u(()=>[l(m,{modelValue:a.value.group_id,"onUpdate:modelValue":e[4]||(e[4]=r=>a.value.group_id=r),data:c.value,props:k,"node-key":"id","check-strictly":"",placeholder:"请选择所属分组",clearable:"",filterable:!0,"allow-create":!0,"default-value":"0"},null,8,["modelValue","data"])]),_:1}),l(t,{label:"状态",prop:"status"},{default:u(()=>[l(x,{modelValue:a.value.status,"onUpdate:modelValue":e[5]||(e[5]=r=>a.value.status=r),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(t,{label:"权重",prop:"weight"},{default:u(()=>[l(C,{modelValue:a.value.weight,"onUpdate:modelValue":e[6]||(e[6]=r=>a.value.weight=r),min:0},null,8,["modelValue"])]),_:1}),l(t,{label:"备注",prop:"remark"},{default:u(()=>[l(s,{modelValue:a.value.remark,"onUpdate:modelValue":e[7]||(e[7]=r=>a.value.remark=r),type:"textarea"},null,8,["modelValue"])]),_:1}),l(t,null,{default:u(()=>[l(G,{type:"primary",onClick:h},{default:u(()=>[...e[9]||(e[9]=[Q("提交",-1)])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}});export{ae as _};
//# sourceMappingURL=edit.vue_vue_type_style_index_0_lang-Ct8Ap2Rc.js.map
