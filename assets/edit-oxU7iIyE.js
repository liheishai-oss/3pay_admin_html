import{d as R,g as d,aj as S,i as w,w as t,D as T,s as p,C as _,o as f,a,u as v,x as D,j as k,E as N,b as P,y as $,z,c as A,F as G,X as M,q as X,n as y,k as H,an as J,ai as K,_ as L}from"./index-hkkJrp5F.js";/* empty css              */const Q={key:0,class:"form-tip"},W=R({__name:"edit",emits:["refresh"],setup(Y,{expose:E,emit:x}){const r=d(!1),i=d(),l=d({id:0,agent_name:"",username:"",group_id:3,status:1,remark:""}),h=x,m=d({agent_name:[{required:!0,message:"请输入代理商名称",trigger:"blur"}],username:[{required:!1,message:"请输入登录账号",trigger:"blur"}]}),C=()=>{l.value.id===0?m.value.username[0].required=!0:m.value.username[0].required=!1},q=async o=>{try{return(await p({url:`/api/v1/admin/agent/detail/${o}`,method:"GET"})).data}catch(e){console.error("获取详情失败:",e),_.error("获取详情失败")}},U=async(o={})=>{const e={...o};if(Object.assign(l.value,e),e.id>0){const s=await q(e.id);s&&(Object.assign(l.value,s),s.admin&&(l.value.username=s.admin.username))}C(),r.value=!0},j=async()=>{var e;await((e=i.value)==null?void 0:e.validate());const o={...l.value};try{let s;o.id===0?s=await p({url:"/api/v1/admin/agent/add",method:"POST",data:o}):s=await p({url:"/api/v1/admin/agent/edit",method:"POST",data:o}),s.status&&(_.success(s.message||"操作成功"),h("refresh"),r.value=!1)}catch(s){_.error(s.message||"操作失败")}},B=()=>{var o;l.value={id:0,agent_name:"",username:"",group_id:3,status:1,remark:""},(o=i.value)==null||o.clearValidate()};return S(r,o=>{o||B()}),E({open:U}),(o,e)=>{const s=z,u=$,c=P,g=N,F=G,I=M,V=H,b=X,O=T;return f(),w(O,{modelValue:r.value,"onUpdate:modelValue":e[5]||(e[5]=n=>r.value=n),title:l.value.id===0?"新增代理商":"编辑代理商",width:"700px","close-on-click-modal":!1},{default:t(()=>[a(v(D),{model:l.value,"label-width":"120px",rules:m.value,ref_key:"formRef",ref:i},{default:t(()=>[a(g,{gutter:20},{default:t(()=>[a(c,{span:12},{default:t(()=>[a(u,{label:"代理商名称",prop:"agent_name"},{default:t(()=>[a(s,{modelValue:l.value.agent_name,"onUpdate:modelValue":e[0]||(e[0]=n=>l.value.agent_name=n),placeholder:"请输入代理商名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{span:12},{default:t(()=>[a(u,{label:"登录账号",prop:"username"},{default:t(()=>[a(s,{modelValue:l.value.username,"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.username=n),placeholder:"请输入登录账号",clearable:"",disabled:l.value.id>0},null,8,["modelValue","disabled"]),l.value.id>0?(f(),A("div",Q,"账号创建后不可修改")):k("",!0)]),_:1})]),_:1})]),_:1}),l.value.id===0?(f(),w(g,{key:0,gutter:20},{default:t(()=>[a(c,{span:24},{default:t(()=>[a(F,{title:"默认密码为：123456",type:"info",closable:!1,"show-icon":""})]),_:1})]),_:1})):k("",!0),a(u,{label:"状态",prop:"status"},{default:t(()=>[a(I,{modelValue:l.value.status,"onUpdate:modelValue":e[2]||(e[2]=n=>l.value.status=n),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),a(u,{label:"备注",prop:"remark"},{default:t(()=>[a(s,{modelValue:l.value.remark,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value.remark=n),type:"textarea",rows:3,placeholder:"请输入备注信息",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(u,null,{default:t(()=>[a(b,{type:"primary",onClick:j},{default:t(()=>[a(V,null,{default:t(()=>[a(v(J))]),_:1}),e[6]||(e[6]=y(" 提交 ",-1))]),_:1}),a(b,{onClick:e[4]||(e[4]=n=>r.value=!1)},{default:t(()=>[a(V,null,{default:t(()=>[a(v(K))]),_:1}),e[7]||(e[7]=y(" 取消 ",-1))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),ae=L(W,[["__scopeId","data-v-f836476c"]]);export{ae as default};
//# sourceMappingURL=edit-oxU7iIyE.js.map
