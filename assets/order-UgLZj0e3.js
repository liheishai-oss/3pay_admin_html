import{d as ce,g as w,a9 as $,M as fe,c as f,a as t,e as h,w as e,T as ve,u as c,N as H,s as B,q as ge,O as be,P as ke,Q as he,D as we,o,R as Ve,a1 as xe,x as Ce,E as Ee,i as u,j as g,b as De,y as Se,z as ze,ap as Te,as as Ue,aq as Me,at as Ye,n,k as Ie,W as L,U as O,S as Re,X as $e,t as d,a8 as Be,au as Ne,av as Pe,C as Fe,_ as je}from"./index-CoKMWEXT.js";/* empty css                          *//* empty css                   *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                          */import{u as Ge}from"./table.plugin-ZHUPJHDL.js";const He={class:"table-com-search"},Le={class:"search-buttons"},Oe={class:"table-header ba-scroll-style"},qe={class:"table-search"},Ae={style:{width:"100%","overflow-x":"auto"},class:"table-content"},Qe={key:0},We={key:1},Xe={key:2},Je={key:0},Ke={key:5},Ze={class:"table-footer"},et={class:"table-pagination"},tt={key:0},at={key:1},lt={key:3},ot={key:0},nt={key:5},rt={style:{color:"#f56c6c"}},st=ce({__name:"order",setup(ut){const{loadData:q,data:V,refreshData:U,handleSizeChange:A,handleCurrentChange:Q,searchParams:M,isVisible:W,toggleVisibility:X}=Ge("/api/v1/admin/single-royalty/order-list"),J=()=>{const s=new Date,a=s.getFullYear(),z=String(s.getMonth()+1).padStart(2,"0"),b=String(s.getDate()).padStart(2,"0");return`${a}-${z}-${b}`},C=()=>{const s=J();return[`${s} 00:00:00`,`${s} 23:59:59`]},Y=w(C()),_=w({platform_order_no:"",merchant_order_no:"",merchant_id:"",pay_status:"",royalty_status:"",royalty_type:"",start_time:C()[0],end_time:C()[1]}),K=s=>{s&&s.length===2?(_.value.start_time=s[0],_.value.end_time=s[1]):(_.value.start_time="",_.value.end_time="")},N=w([]),I=w(!1),r=w(null),E=w({}),D=$(()=>{var s;return((s=E.value)==null?void 0:s.is_agent)===!0}),Z=$(()=>{var s;return((s=E.value)==null?void 0:s.user_group_id)===1}),S=$(()=>{var a;const s=(a=E.value)==null?void 0:a.user_group_id;return Number(s)===4}),ee=async()=>{try{const s=await B({url:"/api/v1/admin/user/info",method:"GET"});s.status&&(E.value=s.data)}catch(s){console.error("获取用户信息失败:",s)}},te=async()=>{if(!(S.value||D.value))try{const s=await B({url:"/api/v1/admin/order/merchant-list",method:"GET"});s.status&&(N.value=s.data)}catch(s){console.error("获取商户列表失败:",s)}},ae=async()=>{M.value={..._.value},await U()},le=()=>{const s=C();Y.value=s,_.value={platform_order_no:"",merchant_order_no:"",merchant_id:"",pay_status:"",royalty_status:"",royalty_type:"",start_time:s[0],end_time:s[1]},M.value={..._.value},U()},oe=w([]),ne=s=>{oe.value=s},re=async s=>{try{const a=await B({url:`/api/v1/admin/single-royalty/order-detail/${s.id}`,method:"GET"});a.status&&(r.value=a.data,I.value=!0)}catch(a){console.error("获取详情失败:",a),Fe.error("获取详情失败")}};return fe(async()=>{await ee(),await te(),M.value={..._.value},q()}),(s,a)=>{const z=ze,b=Se,k=De,m=Me,T=Te,P=Ee,se=Ye,F=Ie,x=ge,ue=Ce,de=xe,_e=be,v=$e,i=Be,ie=ke,ye=he,y=Pe,pe=Ne,me=we;return o(),f(H,null,[t(ve,{name:"fade"},{default:e(()=>[Ve(h("div",He,[t(de,{class:"search-card",shadow:"never"},{default:e(()=>[t(ue,{model:_.value,"label-width":"100px",class:"search-form"},{default:e(()=>[t(P,{gutter:20},{default:e(()=>[t(k,{span:6},{default:e(()=>[t(b,{label:"平台订单号"},{default:e(()=>[t(z,{modelValue:_.value.platform_order_no,"onUpdate:modelValue":a[0]||(a[0]=l=>_.value.platform_order_no=l),placeholder:"请输入平台订单号",clearable:"","prefix-icon":"Search"},null,8,["modelValue"])]),_:1})]),_:1}),t(k,{span:6},{default:e(()=>[t(b,{label:"商户订单号"},{default:e(()=>[t(z,{modelValue:_.value.merchant_order_no,"onUpdate:modelValue":a[1]||(a[1]=l=>_.value.merchant_order_no=l),placeholder:"请输入商户订单号",clearable:"","prefix-icon":"Search"},null,8,["modelValue"])]),_:1})]),_:1}),!S.value&&!D.value?(o(),u(k,{key:0,span:6},{default:e(()=>[t(b,{label:"商户"},{default:e(()=>[t(T,{modelValue:_.value.merchant_id,"onUpdate:modelValue":a[2]||(a[2]=l=>_.value.merchant_id=l),placeholder:"请选择商户",clearable:"",filterable:"",style:{width:"100%"}},{default:e(()=>[(o(!0),f(H,null,Ue(N.value,l=>(o(),u(m,{key:l.id,label:l.merchant_name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):g("",!0),t(k,{span:6},{default:e(()=>[t(b,{label:"支付状态"},{default:e(()=>[t(T,{modelValue:_.value.pay_status,"onUpdate:modelValue":a[3]||(a[3]=l=>_.value.pay_status=l),placeholder:"请选择订单状态",clearable:"",style:{width:"100%"}},{default:e(()=>[t(m,{label:"全部",value:""}),t(m,{label:"已创建",value:0}),t(m,{label:"已打开",value:4}),t(m,{label:"已支付",value:1}),t(m,{label:"已关闭",value:2}),t(m,{label:"已退款",value:3})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(P,{gutter:20},{default:e(()=>[t(k,{span:6},{default:e(()=>[t(b,{label:"分账状态"},{default:e(()=>[t(T,{modelValue:_.value.royalty_status,"onUpdate:modelValue":a[4]||(a[4]=l=>_.value.royalty_status=l),placeholder:"请选择分账状态",clearable:"",style:{width:"100%"}},{default:e(()=>[t(m,{label:"全部",value:""}),t(m,{label:"待分账",value:0}),t(m,{label:"分账中",value:1}),t(m,{label:"分账成功",value:2}),t(m,{label:"分账失败",value:3})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(k,{span:6},{default:e(()=>[t(b,{label:"分账类型"},{default:e(()=>[t(T,{modelValue:_.value.royalty_type,"onUpdate:modelValue":a[5]||(a[5]=l=>_.value.royalty_type=l),placeholder:"请选择分账类型",clearable:"",style:{width:"100%"}},{default:e(()=>[t(m,{label:"全部",value:""}),t(m,{label:"不分账",value:"none"}),t(m,{label:"单笔分账",value:"single"}),t(m,{label:"商家分账",value:"merchant"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(k,{span:6},{default:e(()=>[t(b,{label:"时间范围"},{default:e(()=>[t(se,{modelValue:Y.value,"onUpdate:modelValue":a[6]||(a[6]=l=>Y.value=l),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"100%"},onChange:K,clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(k,{span:6},{default:e(()=>[t(b,null,{default:e(()=>[h("div",Le,[t(x,{type:"primary",onClick:ae},{default:e(()=>[t(F,null,{default:e(()=>[t(c(L))]),_:1}),a[10]||(a[10]=n("搜索 ",-1))]),_:1}),t(x,{onClick:le},{default:e(()=>[t(F,null,{default:e(()=>[t(c(O))]),_:1}),a[11]||(a[11]=n("重置 ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[Re,c(W)]])]),_:1}),h("div",Oe,[t(x,{icon:c(O),onClick:c(U),color:"#40485b"},null,8,["icon","onClick"]),h("div",qe,[t(_e,{class:"ml-4"},{default:e(()=>[t(x,{icon:c(L),onClick:c(X)},null,8,["icon","onClick"])]),_:1})])]),h("div",Ae,[t(ie,{data:c(V).data,border:"",stripe:"","max-height":"600",style:{width:"100%"},onSelectionChange:ne},{default:e(()=>[t(v,{type:"selection",width:"40"}),t(v,{label:"分账主体",align:"center","min-width":"150"},{default:e(({row:l})=>[n(d(l.royalty_subject_name||"-"),1)]),_:1}),t(v,{prop:"order_no",label:"订单号",align:"center","min-width":"200"},{default:e(({row:l})=>[n(d(l.order_no||l.platform_order_no||"-"),1)]),_:1}),t(v,{label:"收款账号",align:"center","min-width":"180"},{default:e(({row:l})=>[n(d(l.payee_account||"-"),1)]),_:1}),t(v,{label:"订单金额",align:"center",width:"100"},{default:e(({row:l})=>[n(" ¥"+d(l.order_amount||"0.00"),1)]),_:1}),t(v,{label:"分账金额",align:"center",width:"100"},{default:e(({row:l})=>[l.royalty_amount>0?(o(),f("span",Qe,"¥"+d(l.royalty_amount),1)):(o(),f("span",We,"-"))]),_:1}),t(v,{label:"分账方式",align:"center",width:"100"},{default:e(({row:l})=>[l.royalty_method==="manual"?(o(),u(i,{key:0,type:"warning"},{default:e(()=>[...a[12]||(a[12]=[n("手动",-1)])]),_:1})):l.royalty_method==="auto"?(o(),u(i,{key:1,type:"success"},{default:e(()=>[...a[13]||(a[13]=[n("自动",-1)])]),_:1})):(o(),f("span",Xe,"-"))]),_:1}),t(v,{label:"分账状态",align:"center","min-width":"120"},{default:e(({row:l})=>[!l.royalty_status_text||l.royalty_status_text==="-"?(o(),f("span",Je,"-")):l.royalty_status_text==="待分账"?(o(),u(i,{key:1,type:"info"},{default:e(()=>[...a[14]||(a[14]=[n("待分账",-1)])]),_:1})):l.royalty_status_text==="分账中"?(o(),u(i,{key:2,type:"warning"},{default:e(()=>[...a[15]||(a[15]=[n("分账中",-1)])]),_:1})):l.royalty_status_text==="分账成功"?(o(),u(i,{key:3,type:"success"},{default:e(()=>[...a[16]||(a[16]=[n("分账成功",-1)])]),_:1})):l.royalty_status_text==="分账失败"?(o(),u(i,{key:4,type:"danger"},{default:e(()=>[...a[17]||(a[17]=[n("分账失败",-1)])]),_:1})):(o(),f("span",Ke,d(l.royalty_status_text),1))]),_:1}),t(v,{label:"分账时间",align:"center","min-width":"160"},{default:e(({row:l})=>[n(d(l.royalty_time||"-"),1)]),_:1}),t(v,{label:"备注",align:"center","min-width":"150"},{default:e(({row:l})=>[n(d(l.order_remark||"-"),1)]),_:1}),t(v,{label:"操作",align:"center",fixed:"right","min-width":"100"},{default:e(l=>[t(x,{size:"small",type:"primary",onClick:R=>re(l.row)},{default:e(()=>[...a[18]||(a[18]=[n("详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),h("div",Ze,[h("div",et,[t(ye,{"current-page":c(V).current_page,"onUpdate:currentPage":a[7]||(a[7]=l=>c(V).current_page=l),"page-size":c(V).page_size,"onUpdate:pageSize":a[8]||(a[8]=l=>c(V).page_size=l),"page-sizes":[10,50,100,200],background:!0,"prev-text":"上一页","next-text":"下一页",layout:"total, sizes, prev, pager, next, jumper",total:c(V).page_total,onSizeChange:c(A),onCurrentChange:c(Q)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),t(me,{modelValue:I.value,"onUpdate:modelValue":a[9]||(a[9]=l=>I.value=l),title:"分账订单详情",width:"800px"},{default:e(()=>[r.value?(o(),u(pe,{key:0,column:2,border:""},{default:e(()=>{var l,R,j;return[t(y,{label:"平台订单号"},{default:e(()=>[n(d(r.value.platform_order_no),1)]),_:1}),t(y,{label:"商户订单号"},{default:e(()=>[n(d(r.value.merchant_order_no),1)]),_:1}),t(y,{label:"订单金额"},{default:e(()=>[n("¥"+d(r.value.order_amount),1)]),_:1}),t(y,{label:"分账金额"},{default:e(()=>[r.value.royalty_amount>0?(o(),f("span",tt,"¥"+d(r.value.royalty_amount),1)):(o(),f("span",at,"-"))]),_:1}),Z.value?(o(),u(y,{key:0,label:"代理商"},{default:e(()=>{var p;return[n(d(((p=r.value.agent)==null?void 0:p.agent_name)||"-"),1)]}),_:1})):g("",!0),!S.value&&!D.value?(o(),u(y,{key:1,label:"商户"},{default:e(()=>{var p;return[n(d(((p=r.value.merchant)==null?void 0:p.merchant_name)||"-"),1)]}),_:1})):g("",!0),t(y,{label:"产品"},{default:e(()=>{var p;return[n(d(((p=r.value.product)==null?void 0:p.product_name)||"-"),1)]}),_:1}),!S.value&&!D.value?(o(),u(y,{key:2,label:"主体"},{default:e(()=>{var p;return[n(d(((p=r.value.subject)==null?void 0:p.company_name)||"-"),1)]}),_:1})):g("",!0),t(y,{label:"分账类型"},{default:e(()=>[r.value.royalty_type==="none"?(o(),u(i,{key:0,type:"info"},{default:e(()=>[...a[19]||(a[19]=[n("不分账",-1)])]),_:1})):r.value.royalty_type==="single"?(o(),u(i,{key:1,type:"success"},{default:e(()=>[...a[20]||(a[20]=[n("单笔分账",-1)])]),_:1})):r.value.royalty_type==="merchant"?(o(),u(i,{key:2,type:"warning"},{default:e(()=>[...a[21]||(a[21]=[n("商家分账",-1)])]),_:1})):(o(),f("span",lt,"-"))]),_:1}),t(y,{label:"支付状态"},{default:e(()=>[r.value.pay_status===0?(o(),u(i,{key:0,type:"info"},{default:e(()=>[...a[22]||(a[22]=[n("已创建",-1)])]),_:1})):r.value.pay_status===4?(o(),u(i,{key:1,type:"warning"},{default:e(()=>[...a[23]||(a[23]=[n("已打开",-1)])]),_:1})):r.value.pay_status===1?(o(),u(i,{key:2,type:"success"},{default:e(()=>[...a[24]||(a[24]=[n("已支付",-1)])]),_:1})):r.value.pay_status===2?(o(),u(i,{key:3,type:"warning"},{default:e(()=>[...a[25]||(a[25]=[n("已关闭",-1)])]),_:1})):r.value.pay_status===3?(o(),u(i,{key:4,type:"danger"},{default:e(()=>[...a[26]||(a[26]=[n("已退款",-1)])]),_:1})):g("",!0)]),_:1}),t(y,{label:"分账状态"},{default:e(()=>[!r.value.royalty_status_text||r.value.royalty_status_text==="-"?(o(),f("span",ot,"-")):r.value.royalty_status_text==="待分账"?(o(),u(i,{key:1,type:"info"},{default:e(()=>[...a[27]||(a[27]=[n("待分账",-1)])]),_:1})):r.value.royalty_status_text==="分账中"?(o(),u(i,{key:2,type:"warning"},{default:e(()=>[...a[28]||(a[28]=[n("分账中",-1)])]),_:1})):r.value.royalty_status_text==="分账成功"?(o(),u(i,{key:3,type:"success"},{default:e(()=>[...a[29]||(a[29]=[n("分账成功",-1)])]),_:1})):r.value.royalty_status_text==="分账失败"?(o(),u(i,{key:4,type:"danger"},{default:e(()=>[...a[30]||(a[30]=[n("分账失败",-1)])]),_:1})):(o(),f("span",nt,d(r.value.royalty_status_text),1))]),_:1}),r.value.royalty_record?(o(),u(y,{key:3,label:"收款人姓名"},{default:e(()=>{var p;return[n(d(((p=r.value.royalty_record)==null?void 0:p.payee_name)||"-"),1)]}),_:1})):g("",!0),r.value.royalty_record?(o(),u(y,{key:4,label:"收款人账号"},{default:e(()=>{var p,G;return[n(d(((p=r.value.royalty_record)==null?void 0:p.payee_account)||((G=r.value.royalty_record)==null?void 0:G.payee_user_id)||"-"),1)]}),_:1})):g("",!0),(l=r.value.royalty_record)!=null&&l.alipay_royalty_no?(o(),u(y,{key:5,label:"分账单号"},{default:e(()=>[n(d(r.value.royalty_record.alipay_royalty_no),1)]),_:1})):g("",!0),(R=r.value.royalty_record)!=null&&R.royalty_time?(o(),u(y,{key:6,label:"分账时间"},{default:e(()=>[n(d(r.value.royalty_record.royalty_time),1)]),_:1})):g("",!0),t(y,{label:"创建时间"},{default:e(()=>[n(d(r.value.created_at),1)]),_:1}),t(y,{label:"支付时间"},{default:e(()=>[n(d(r.value.pay_time||"-"),1)]),_:1}),(j=r.value.royalty_record)!=null&&j.royalty_error?(o(),u(y,{key:7,label:"分账失败原因",span:2},{default:e(()=>[h("span",rt,d(r.value.royalty_record.royalty_error),1)]),_:1})):g("",!0)]}),_:1})):g("",!0)]),_:1},8,["modelValue"])],64)}}}),vt=je(st,[["__scopeId","data-v-4c57938f"]]);export{vt as default};
//# sourceMappingURL=order-UgLZj0e3.js.map
