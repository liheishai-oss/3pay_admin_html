{"version":3,"mappings":"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","names":["EditForm","defineAsyncComponent","__vitePreload","editFormRef","ref","openEditFrom","row","handleSelectionChange","hasSelectedRows","showSearch","toggleSearch","loadData","data","refreshData","originalHandleSizeChange","originalHandleCurrentChange","searchParams","deleteRows","toggleSwitch","useTableDataPlugin","getCircuitStatus","res","request","error","handleSizeChange","size","handleCurrentChange","page","searchForm","agentList","userInfo","isAgent","computed","_a","getUserInfo","getAgentList","handleSearch","refreshDataWithCircuitStatus","handleReset","handleResetApiKey","ElMessageBox","ElMessage","formatRemainTime","seconds","minutes","secs","handleClearCircuit","loadDataWithCircuitStatus","onMounted","handleDelete","api","handleBatchDelete","apiDocsVisible","currentMerchant","apiInfoText","openApiDocs","merchant","generateApiInfoText","apiInfo","copyAllApiInfo","textarea","_createVNode","_unref","_component_el_dialog","$event","_createElementVNode","_hoisted_4","_component_el_button","_cache","_openBlock","_createElementBlock","_hoisted_1","_component_el_card","_hoisted_2","DocumentCopy","_hoisted_3","_component_el_input","_Transition","_withDirectives","_hoisted_5","_component_el_row","_createBlock","_component_el_col","_component_el_form_item","_component_el_select","_Fragment","_renderList","agent","_component_el_option","_component_el_form","_hoisted_6","Refresh","Plus","_hoisted_7","_component_el_button_group","Search","_hoisted_8","_component_el_table","_component_el_table_column","_withCtx","_component_el_switch","_component_el_tag","_toDisplayString","scope","_hoisted_9","_hoisted_10","_component_el_pagination"],"ignoreList":[],"sources":["../../src/pages/merchant/home.vue"],"sourcesContent":["<template>\n  <!-- 编辑表单对话框 -->\n  <EditForm ref=\"editFormRef\" @refresh=\"refreshData\"/>\n  \n  <!-- 对接资料对话框 -->\n  <el-dialog\n    v-model=\"apiDocsVisible\"\n    title=\"对接资料\"\n    width=\"600px\"\n    :close-on-click-modal=\"false\"\n  >\n    <div v-if=\"currentMerchant\" class=\"api-docs-content\">\n      <!-- 对接信息 -->\n      <el-card class=\"api-info-card\" shadow=\"never\">\n        <template #header>\n          <div class=\"card-header\">\n            <span>对接信息</span>\n            <el-button \n              type=\"primary\" \n              size=\"small\" \n              @click=\"copyAllApiInfo\"\n              :icon=\"DocumentCopy\"\n            >\n              一键复制全部\n            </el-button>\n          </div>\n        </template>\n        \n        <!-- 完整对接信息文本区域 -->\n        <div class=\"api-info-textarea\">\n          <el-input\n            v-model=\"apiInfoText\"\n            type=\"textarea\"\n            :rows=\"12\"\n            readonly\n            placeholder=\"对接信息加载中...\"\n            class=\"api-info-text\"\n          />\n        </div>\n        \n      </el-card>\n    </div>\n\n    <template #footer>\n      <div class=\"dialog-footer\">\n        <el-button @click=\"apiDocsVisible = false\">关闭</el-button>\n      </div>\n    </template>\n  </el-dialog>\n  \n  <!-- 搜索菜单部分的过渡效果 -->\n  <transition name=\"fade\">\n    <div class=\"table-com-search\" v-show=\"showSearch\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"6\" v-if=\"!isAgent\">\n          <el-form-item label=\"代理商\">\n            <el-select v-model=\"searchForm.agent_id\" placeholder=\"选择代理商\" clearable filterable>\n              <el-option\n                v-for=\"agent in agentList\"\n                :key=\"agent.id\"\n                :label=\"agent.agent_name\"\n                :value=\"agent.id\"\n              />\n            </el-select>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-form-item label=\"商户名称\">\n            <el-input \n              v-model=\"searchForm.merchant_name\" \n              placeholder=\"按商户名称搜索\" \n              clearable \n            />\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-form-item label=\"状态\">\n            <el-select v-model=\"searchForm.status\" placeholder=\"选择状态\" clearable>\n              <el-option label=\"全部\" :value=\"''\" />\n              <el-option label=\"启用\" :value=\"1\" />\n              <el-option label=\"禁用\" :value=\"0\" />\n            </el-select>\n          </el-form-item>\n        </el-col>\n      </el-row>\n\n      <!-- 搜索按钮和重置按钮 -->\n      <el-form :inline=\"true\" class=\"demo-form-inline\">\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"handleSearch\">搜索</el-button>\n          <el-button type=\"primary\" @click=\"handleReset\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n  </transition>\n\n  <!-- 表头 -->\n  <div class=\"table-header ba-scroll-style\">\n    <!-- 刷新、添加、删除按钮 -->\n    <el-button :icon=\"Refresh\" @click=\"refreshDataWithCircuitStatus\" color=\"#40485b\"/>\n    <el-button type=\"primary\" :icon=\"Plus\" @click=\"openEditFrom\">添加</el-button>\n    <el-button type=\"danger\" :disabled=\"!hasSelectedRows\" @click=\"handleBatchDelete('/api/v1/admin/merchant/delete')\">删除</el-button>\n\n    <!-- 搜索按钮 -->\n    <div class=\"table-search\">\n      <el-button-group class=\"ml-4\">\n        <el-button :icon=\"Search\" @click=\"toggleSearch\" />\n      </el-button-group>\n    </div>\n  </div>\n\n  <!-- 表格内容 -->\n  <div style=\"width: 100%; overflow-x: auto;\" class=\"table-content\">\n    <el-table\n        :data=\"data.data\"\n        border\n        stripe\n        max-height=\"600\"\n        style=\"width: 100%;\" \n        @selection-change=\"handleSelectionChange\">\n      <!-- 表格列定义 -->\n      <el-table-column type=\"selection\" width=\"40\"/>\n      <el-table-column prop=\"agent.agent_name\" label=\"代理商\" align=\"center\" min-width=\"150\" v-if=\"!isAgent\"/>\n      <el-table-column prop=\"merchant_name\" label=\"商户名称\" align=\"center\" min-width=\"200\"/>\n      <el-table-column prop=\"username\" label=\"账号\" align=\"center\" min-width=\"150\"/>\n\n      <!-- 状态列 -->\n      <el-table-column label=\"状态\" align=\"center\" min-width=\"90\">\n        <template #default=\"{ row }\">\n          <el-switch \n            v-model=\"row.status\" \n            :active-value=\"1\" \n            :inactive-value=\"0\" \n            @change=\"toggleSwitch('/api/v1/admin/merchant/switch', row.id)\"\n          />\n        </template>\n      </el-table-column>\n\n      <!-- 熔断状态列 -->\n      <el-table-column label=\"熔断状态\" align=\"center\" min-width=\"120\">\n        <template #default=\"{ row }\">\n          <el-tag \n            v-if=\"row.circuit_status?.is_circuit_open\" \n            type=\"danger\" \n            size=\"small\"\n          >\n            熔断中 ({{ formatRemainTime(row.circuit_status.remain_seconds) }})\n          </el-tag>\n          <el-tag v-else type=\"success\" size=\"small\">正常</el-tag>\n        </template>\n      </el-table-column>\n\n      <el-table-column prop=\"created_at\" label=\"创建时间\" align=\"center\" min-width=\"150\"/>\n\n      <!-- 操作列 -->\n      <el-table-column label=\"操作\" align=\"center\" fixed=\"right\" min-width=\"400\">\n        <template #default=\"scope\">\n          <el-button size=\"small\" @click=\"openEditFrom(scope.row)\">编辑</el-button>\n          <el-button size=\"small\" type=\"info\" @click=\"openApiDocs(scope.row)\">对接资料</el-button>\n          <el-button size=\"small\" type=\"warning\" @click=\"handleResetApiKey(scope.row)\">重置密钥</el-button>\n          <el-button \n            size=\"small\" \n            type=\"danger\" \n            :disabled=\"!scope.row.circuit_status?.is_circuit_open\"\n            @click=\"handleClearCircuit(scope.row)\"\n          >\n            解除熔断\n          </el-button>\n          <el-button size=\"small\" type=\"danger\" @click=\"handleDelete('/api/v1/admin/merchant/delete', scope.row)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n  </div>\n\n  <!-- 表格分页 -->\n  <div class=\"table-footer\">\n    <div class=\"table-pagination\">\n      <el-pagination\n          v-model:current-page=\"data.current_page\"\n          v-model:page-size=\"data.page_size\"\n          :page-sizes=\"[10, 50, 100, 200]\"\n          :background=\"true\"\n          prev-text=\"上一页\"\n          next-text=\"下一页\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"data.page_total\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { Plus, Refresh, Search, DocumentCopy } from '@element-plus/icons-vue';\nimport { ref, onMounted, defineAsyncComponent, computed } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport request from '@/utils/request';\n\n// 引入自定义插件和 API\nimport { useTableDataPlugin } from \"@/utils/plugins/table.plugin.ts\";\n\n// 导入编辑\nconst EditForm = defineAsyncComponent(() => import('./edit.vue'));\n// 导入编辑页面\nconst editFormRef = ref(null);\nconst openEditFrom = (row = {}) => {\n  console.log(row);\n  if (editFormRef.value) {\n    editFormRef.value.open({ ...row }); // 传递 `row` 作为参数\n  } else {\n    console.error(\"EditForm 组件未正确挂载！\");\n  }\n};\n\n// 使用表格插件来管理表格的状态、数据等\nconst {\n  handleSelectionChange,\n  hasSelectedRows,\n  isVisible: showSearch,\n  toggleVisibility: toggleSearch,\n  loadData,\n  data,\n  refreshData,\n  handleSizeChange: originalHandleSizeChange,\n  handleCurrentChange: originalHandleCurrentChange,\n  searchParams,\n  deleteRows,\n  toggleSwitch,\n  resetSearchParams\n} = useTableDataPlugin(\"/api/v1/admin/merchant/list\");\n\n// 获取商户熔断状态（提前定义）\nconst getCircuitStatus = async (row: any) => {\n  try {\n    const res = await request({\n      url: `/api/v1/admin/merchant/circuit-status/${row.id}`,\n      method: 'GET'\n    });\n    if (res.status) {\n      row.circuit_status = res.data;\n    }\n  } catch (error) {\n    console.error('获取熔断状态失败:', error);\n    row.circuit_status = { is_circuit_open: false, remain_seconds: 0 };\n  }\n};\n\n// 包装分页处理函数，在分页变化后加载熔断状态\nconst handleSizeChange = async (size: number) => {\n  await originalHandleSizeChange(size);\n  if (data.value.data && data.value.data.length > 0) {\n    await Promise.all(data.value.data.map((row: any) => getCircuitStatus(row)));\n  }\n};\n\nconst handleCurrentChange = async (page: number) => {\n  await originalHandleCurrentChange(page);\n  if (data.value.data && data.value.data.length > 0) {\n    await Promise.all(data.value.data.map((row: any) => getCircuitStatus(row)));\n  }\n};\n\n// 搜索表单数据\nconst searchForm = ref({\n  agent_id: '',\n  merchant_name: '',\n  contact_name: '',\n  contact_phone: '',\n  status: ''\n});\n\n// 代理商列表\nconst agentList = ref([]);\n\n// 获取用户信息判断是否是代理商\nconst userInfo = ref<any>({});\nconst isAgent = computed(() => {\n  return userInfo.value?.is_agent === true;\n});\n\n// 获取用户信息\nconst getUserInfo = async () => {\n  try {\n    const res = await request({\n      url: '/api/v1/admin/user/info',\n      method: 'GET'\n    });\n    if (res.status) {\n      userInfo.value = res.data;\n    }\n  } catch (error) {\n    console.error('获取用户信息失败:', error);\n  }\n};\n\n// 获取代理商列表（仅管理员需要）\nconst getAgentList = async () => {\n  if (isAgent.value) return;\n  \n  try {\n    const res = await request({\n      url: '/api/v1/admin/merchant/agent-list',\n      method: 'GET'\n    });\n    if (res.status) {\n      agentList.value = res.data;\n    }\n  } catch (error) {\n    console.error('获取代理商列表失败:', error);\n  }\n};\n\n// 处理搜索\nconst handleSearch = async () => {\n  // 将搜索表单数据同步到searchParams\n  searchParams.value = { ...searchForm.value };\n  await refreshDataWithCircuitStatus();\n};\n\n// 处理重置\nconst handleReset = () => {\n  searchForm.value = {\n    agent_id: '',\n    merchant_name: '',\n    contact_name: '',\n    contact_phone: '',\n    status: ''\n  };\n  searchParams.value = { ...searchForm.value };\n  refreshDataWithCircuitStatus();\n};\n\n// 重置API密钥\nconst handleResetApiKey = async (row: any) => {\n  try {\n    await ElMessageBox.confirm('确定要重置该商户的API密钥吗？重置后原密钥将失效！', '警告', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning'\n    });\n    \n    const res = await request({\n      url: '/api/v1/admin/merchant/reset-api-key',\n      method: 'POST',\n      data: { id: row.id }\n    });\n    \n    if (res.status) {\n      await ElMessageBox.alert(\n        `<div style=\"word-break: break-all;\">\n          <p><strong>API Key:</strong><br/>${res.data.api_key}</p>\n          <p style=\"margin-top: 10px;\"><strong>API Secret:</strong><br/>${res.data.api_secret}</p>\n        </div>`,\n        '新的API密钥',\n        {\n          dangerouslyUseHTMLString: true,\n          confirmButtonText: '我已复制',\n        }\n      );\n      // 刷新列表数据，更新显示的密钥信息\n      await refreshDataWithCircuitStatus();\n    } else {\n      ElMessage.error(res.msg || '重置失败');\n    }\n  } catch (error) {\n    if (error !== 'cancel') {\n      console.error('重置失败:', error);\n      ElMessage.error('重置失败');\n    }\n  }\n};\n\n// 格式化剩余时间\nconst formatRemainTime = (seconds: number) => {\n  if (seconds <= 0) return '0秒';\n  const minutes = Math.floor(seconds / 60);\n  const secs = seconds % 60;\n  if (minutes > 0) {\n    return `${minutes}分${secs}秒`;\n  }\n  return `${secs}秒`;\n};\n\n// 解除熔断\nconst handleClearCircuit = async (row: any) => {\n  try {\n    await ElMessageBox.confirm('确定要解除该商户的熔断状态吗？', '解除熔断', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning'\n    });\n    \n    const res = await request({\n      url: '/api/v1/admin/merchant/clear-circuit',\n      method: 'POST',\n      data: { merchant_id: row.id }\n    });\n    \n    if (res.status) {\n      ElMessage.success(res.msg || '熔断已成功解除');\n      // 刷新熔断状态\n      await getCircuitStatus(row);\n      // 刷新列表数据\n      await refreshData();\n    } else {\n      ElMessage.error(res.msg || '解除熔断失败');\n    }\n  } catch (error) {\n    if (error !== 'cancel') {\n      console.error('解除熔断失败:', error);\n      ElMessage.error('解除熔断失败');\n    }\n  }\n};\n\n// 加载数据后获取每个商户的熔断状态\nconst loadDataWithCircuitStatus = async () => {\n  await loadData();\n  // 为每个商户获取熔断状态\n  if (data.value.data && data.value.data.length > 0) {\n    await Promise.all(data.value.data.map((row: any) => getCircuitStatus(row)));\n  }\n};\n\n// 刷新数据（包含熔断状态）\nconst refreshDataWithCircuitStatus = async () => {\n  await refreshData();\n  // 为每个商户获取熔断状态\n  if (data.value.data && data.value.data.length > 0) {\n    await Promise.all(data.value.data.map((row: any) => getCircuitStatus(row)));\n  }\n};\n\n// 在组件挂载时加载数据\nonMounted(async () => {\n  await getUserInfo();\n  await getAgentList();\n  await loadDataWithCircuitStatus();\n});\n\n// 删除方法：单条删除\nconst handleDelete = (api: string, row: any) => {\n  deleteRows(api, [row.id]);  // 传递一个 id 数组来删除单条记录\n};\n\n// 批量删除\nconst handleBatchDelete = (api: string) => {\n  deleteRows(api);\n};\n\n// 对接资料对话框\nconst apiDocsVisible = ref(false);\nconst currentMerchant = ref<any>(null);\nconst apiInfoText = ref('');\n\n// 打开对接资料对话框\nconst openApiDocs = async (merchant: any) => {\n  // 每次打开都重新获取最新的商户详情，确保显示最新的密钥信息\n  try {\n    const res = await request({\n      url: `/api/v1/admin/merchant/detail/${merchant.id}`,\n      method: 'GET'\n    });\n    if (res.status) {\n      merchant = { ...merchant, ...res.data };\n    } else {\n      ElMessage.error('获取商户详情失败');\n      return;\n    }\n  } catch (error) {\n    console.error('获取商户详情失败:', error);\n    ElMessage.error('获取商户详情失败');\n    return;\n  }\n  \n  currentMerchant.value = merchant;\n  generateApiInfoText();\n  apiDocsVisible.value = true;\n};\n\n// 生成对接信息文本\nconst generateApiInfoText = () => {\n  if (!currentMerchant.value) return;\n  \n  const merchant = currentMerchant.value;\n  const apiInfo = `=== 百亿支付对接信息 ===\n\n商户名称：${merchant.merchant_name || '未设置'}\n商户Key：${merchant.api_key || '未生成'}\n商户秘钥：${merchant.api_secret || '未生成'}\n回调IP：34.92.49.193,34.150.65.167\n\nAPI接口信息：\nAPI网关：https://api.baiyi-pay.com\nAPI文档：https://www.baiyi-pay.com/docs.html\n\n接口说明：\n1. 所有接口请求都需要进行签名验证\n2. 签名算法：MD5(参数按key排序后拼接 + 商户秘钥)\n3. 请求方式：POST\n4. 数据格式：JSON\n5. 字符编码：UTF-8\n\n回调说明：\n- 支付成功后系统会主动回调商户的notify_url\n- 回调参数包含订单状态和签名信息\n- 商户收到回调后需要返回\"success\"字符串确认（不区分大小写）\n- HTTP状态码必须返回200，响应内容必须为\"SUCCESS\"\n\n熔断机制：\n- 连续超时5次：如果商户回调接口连续5次超时（超过10秒未响应），系统将触发熔断，暂停自动回调5分钟\n- 连续非期望响应5次：如果商户回调接口连续5次返回非200状态码或响应内容不是\"SUCCESS\"，系统将触发熔断，暂停自动回调5分钟\n- 熔断恢复：回调成功后自动恢复，或等待5分钟后自动恢复\n- 建议：请确保回调接口稳定可用，响应时间控制在10秒以内，避免触发熔断机制\n\n注意事项：\n1. 请妥善保管商户Key和商户秘钥\n2. 必须使用HTTPS协议进行接口调用\n3. 回调地址必须是公网可访问的URL\n4. 如有疑问请联系技术支持\n\n生成时间：${new Date().toLocaleString()}`;\n\n  apiInfoText.value = apiInfo;\n};\n\n// 一键复制全部对接信息\nconst copyAllApiInfo = async () => {\n  try {\n    await navigator.clipboard.writeText(apiInfoText.value);\n    ElMessage.success('完整对接信息已复制到剪贴板');\n  } catch (err) {\n    // 降级方案：使用传统复制方法\n    const textarea = document.createElement('textarea');\n    textarea.value = apiInfoText.value;\n    textarea.style.position = 'fixed';\n    textarea.style.opacity = '0';\n    document.body.appendChild(textarea);\n    textarea.select();\n    try {\n      document.execCommand('copy');\n      ElMessage.success('完整对接信息已复制到剪贴板');\n    } catch (e) {\n      ElMessage.error('复制失败，请手动复制');\n    }\n    document.body.removeChild(textarea);\n  }\n};\n\n</script>\n\n<style scoped>\n/* 对接资料对话框样式 */\n.api-docs-content {\n  max-height: 500px;\n  overflow-y: auto;\n}\n\n.api-info-card {\n  margin-bottom: 16px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-weight: 600;\n  color: #303133;\n}\n\n/* 对接信息文本区域样式 */\n.api-info-textarea {\n  margin-bottom: 16px;\n}\n\n.api-info-text :deep(.el-textarea__inner) {\n  font-family: 'Courier New', monospace;\n  font-size: 13px;\n  line-height: 1.5;\n  background-color: #f8f9fa;\n  border: 1px solid #e9ecef;\n  color: #495057;\n  resize: none;\n}\n\n.api-info-text :deep(.el-textarea__inner):focus {\n  border-color: #409eff;\n  box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.1);\n}\n\n.dialog-footer {\n  text-align: right;\n}\n</style>\n\n"],"file":"assets/home-CYp0XmaZ.js"}