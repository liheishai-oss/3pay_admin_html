import{d as T,r as d,ap as F,g as b,w as t,U as N,s as p,E as _,n as f,e as a,J as v,Q as j,f as k,i as D,v as P,R as $,S as A,a as G,V as J,a6 as M,l as Q,p as E,I as z,at as H,ao as K,_ as L}from"./index-BeGCk70a.js";/* empty css              */const W={key:0,class:"form-tip"},X=T({__name:"edit",emits:["refresh"],setup(Y,{expose:y,emit:x}){const r=d(!1),i=d(),l=d({id:0,agent_name:"",username:"",group_id:3,status:1,remark:""}),h=x,m=d({agent_name:[{required:!0,message:"请输入代理商名称",trigger:"blur"}],username:[{required:!1,message:"请输入登录账号",trigger:"blur"}]}),C=()=>{l.value.id===0?m.value.username[0].required=!0:m.value.username[0].required=!1},U=async o=>{try{return(await p({url:`/api/v1/admin/agent/detail/${o}`,method:"GET"})).data}catch(e){console.error("获取详情失败:",e),_.error("获取详情失败")}},I=async(o={})=>{const e={...o};if(Object.assign(l.value,e),e.id>0){const s=await U(e.id);s&&(Object.assign(l.value,s),s.admin&&(l.value.username=s.admin.username))}C(),r.value=!0},R=async()=>{var e;await((e=i.value)==null?void 0:e.validate());const o={...l.value};try{let s;o.id===0?s=await p({url:"/api/v1/admin/agent/add",method:"POST",data:o}):s=await p({url:"/api/v1/admin/agent/edit",method:"POST",data:o}),s.status&&(_.success(s.message||"操作成功"),h("refresh"),r.value=!1)}catch(s){_.error(s.message||"操作失败")}},S=()=>{var o;l.value={id:0,agent_name:"",username:"",group_id:3,status:1,remark:""},(o=i.value)==null||o.clearValidate()};return F(r,o=>{o||S()}),y({open:I}),(o,e)=>{const s=A,u=$,c=P,g=D,q=J,B=M,V=z,w=Q,O=N;return f(),b(O,{modelValue:r.value,"onUpdate:modelValue":e[5]||(e[5]=n=>r.value=n),title:l.value.id===0?"新增代理商":"编辑代理商",width:"700px","close-on-click-modal":!1},{default:t(()=>[a(v(j),{model:l.value,"label-width":"120px",rules:m.value,ref_key:"formRef",ref:i},{default:t(()=>[a(g,{gutter:20},{default:t(()=>[a(c,{span:12},{default:t(()=>[a(u,{label:"代理商名称",prop:"agent_name"},{default:t(()=>[a(s,{modelValue:l.value.agent_name,"onUpdate:modelValue":e[0]||(e[0]=n=>l.value.agent_name=n),placeholder:"请输入代理商名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{span:12},{default:t(()=>[a(u,{label:"登录账号",prop:"username"},{default:t(()=>[a(s,{modelValue:l.value.username,"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.username=n),placeholder:"请输入登录账号",clearable:"",disabled:l.value.id>0},null,8,["modelValue","disabled"]),l.value.id>0?(f(),G("div",W,"账号创建后不可修改")):k("",!0)]),_:1})]),_:1})]),_:1}),l.value.id===0?(f(),b(g,{key:0,gutter:20},{default:t(()=>[a(c,{span:24},{default:t(()=>[a(q,{title:"默认密码为：123456",type:"info",closable:!1,"show-icon":""})]),_:1})]),_:1})):k("",!0),a(u,{label:"状态",prop:"status"},{default:t(()=>[a(B,{modelValue:l.value.status,"onUpdate:modelValue":e[2]||(e[2]=n=>l.value.status=n),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),a(u,{label:"备注",prop:"remark"},{default:t(()=>[a(s,{modelValue:l.value.remark,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value.remark=n),type:"textarea",rows:3,placeholder:"请输入备注信息",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(u,null,{default:t(()=>[a(w,{type:"primary",onClick:R},{default:t(()=>[a(V,null,{default:t(()=>[a(v(H))]),_:1}),e[6]||(e[6]=E(" 提交 ",-1))]),_:1}),a(w,{onClick:e[4]||(e[4]=n=>r.value=!1)},{default:t(()=>[a(V,null,{default:t(()=>[a(v(K))]),_:1}),e[7]||(e[7]=E(" 取消 ",-1))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),ae=L(X,[["__scopeId","data-v-f836476c"]]);export{ae as default};
//# sourceMappingURL=edit-DVBLkLKA.js.map
