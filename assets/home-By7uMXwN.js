const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/edit-Dau6G7oS.js","assets/index-CFTblcIy.js","assets/index-B-isprgm.css","assets/edit-DiNSmR-z.css","assets/alert-CF5VuMnX.css","assets/select-Cg3B10gN.css"])))=>i.map(i=>d[i]);
import{d as le,g as f,a8 as ne,K as oe,c as V,a as e,e as c,u as o,w as l,T as se,L as E,s as k,q as re,M as ie,N as de,O as ue,o as d,an as pe,P as ce,E as me,i as h,j as P,b as _e,y as ge,ao as fe,ar as B,ap as ve,z as be,x as he,n as m,Q as ye,R as Ce,S as we,U as Ve,V as Ee,W as ke,aq as Se}from"./index-CFTblcIy.js";/* empty css                   *//* empty css               *//* empty css                     *//* empty css                 */import{u as ze}from"./table.plugin-D8tqfcxX.js";const xe={class:"table-com-search"},Te={class:"table-header ba-scroll-style"},Ue={class:"table-search"},Re={style:{width:"100%","overflow-x":"auto"},class:"table-content"},Fe={class:"table-footer"},Pe={class:"table-pagination"},$e=le({__name:"home",setup(Be){const D=pe(()=>Se(()=>import("./edit-Dau6G7oS.js"),__vite__mapDeps([0,1,2,3,4,5]))),y=f(null),S=(n={})=>{console.log(n),y.value?y.value.open({...n}):console.error("EditForm 组件未正确挂载！")},{handleSelectionChange:L,hasSelectedRows:I,isVisible:N,toggleVisibility:A,loadData:G,data:u,refreshData:v,handleSizeChange:$,handleCurrentChange:O,searchParams:z,deleteRows:x,toggleSwitch:j}=ze("/api/v1/admin/product/list"),s=f({agent_id:"",product_name:"",product_code:"",payment_type_id:"",status:""}),T=f([]),U=f([]),R=f({}),C=ne(()=>{var n;return((n=R.value)==null?void 0:n.is_agent)===!0}),q=async()=>{try{const n=await k({url:"/api/v1/admin/user/info",method:"GET"});n.status&&(R.value=n.data)}catch(n){console.error("获取用户信息失败:",n)}},M=async()=>{if(!C.value)try{const n=await k({url:"/api/v1/admin/product/agent-list",method:"GET"});n.status&&(T.value=n.data)}catch(n){console.error("获取代理商列表失败:",n)}},K=async()=>{try{const n=await k({url:"/api/v1/admin/product/payment-type-list",method:"GET"});n.status&&(U.value=n.data)}catch(n){console.error("获取支付类型列表失败:",n)}},Q=async()=>{z.value={...s.value},await v()},W=()=>{s.value={agent_id:"",product_name:"",product_code:"",payment_type_id:"",status:""},z.value={...s.value},v()};oe(async()=>{await q(),await M(),await K(),G()});const H=(n,a)=>{x(n,[a.id])},J=n=>{x(n)};return(n,a)=>{const _=ve,w=fe,p=ge,g=_e,F=be,X=me,r=re,Y=he,Z=ie,i=Ee,ee=ke,ae=de,te=ue;return d(),V(E,null,[e(o(D),{ref_key:"editFormRef",ref:y,onRefresh:o(v)},null,8,["onRefresh"]),e(se,{name:"fade"},{default:l(()=>[ce(c("div",xe,[e(X,{gutter:20},{default:l(()=>[C.value?P("",!0):(d(),h(g,{key:0,span:6},{default:l(()=>[e(p,{label:"代理商"},{default:l(()=>[e(w,{modelValue:s.value.agent_id,"onUpdate:modelValue":a[0]||(a[0]=t=>s.value.agent_id=t),placeholder:"选择代理商",clearable:"",filterable:""},{default:l(()=>[(d(!0),V(E,null,B(T.value,t=>(d(),h(_,{key:t.id,label:t.agent_name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})),e(g,{span:6},{default:l(()=>[e(p,{label:"产品名称"},{default:l(()=>[e(F,{modelValue:s.value.product_name,"onUpdate:modelValue":a[1]||(a[1]=t=>s.value.product_name=t),placeholder:"按产品名称搜索",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:6},{default:l(()=>[e(p,{label:"产品编号"},{default:l(()=>[e(F,{modelValue:s.value.product_code,"onUpdate:modelValue":a[2]||(a[2]=t=>s.value.product_code=t),placeholder:"按产品编号搜索",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:6},{default:l(()=>[e(p,{label:"支付类型"},{default:l(()=>[e(w,{modelValue:s.value.payment_type_id,"onUpdate:modelValue":a[3]||(a[3]=t=>s.value.payment_type_id=t),placeholder:"选择支付类型",clearable:"",filterable:""},{default:l(()=>[(d(!0),V(E,null,B(U.value,t=>(d(),h(_,{key:t.id,label:t.product_name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(g,{span:6},{default:l(()=>[e(p,{label:"状态"},{default:l(()=>[e(w,{modelValue:s.value.status,"onUpdate:modelValue":a[4]||(a[4]=t=>s.value.status=t),placeholder:"选择状态",clearable:""},{default:l(()=>[e(_,{label:"全部",value:""}),e(_,{label:"启用",value:1}),e(_,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Y,{inline:!0,class:"demo-form-inline"},{default:l(()=>[e(p,null,{default:l(()=>[e(r,{type:"primary",onClick:Q},{default:l(()=>[...a[8]||(a[8]=[m("搜索",-1)])]),_:1}),e(r,{type:"primary",onClick:W},{default:l(()=>[...a[9]||(a[9]=[m("重置",-1)])]),_:1})]),_:1})]),_:1})],512),[[ye,o(N)]])]),_:1}),c("div",Te,[e(r,{icon:o(Ce),onClick:o(v),color:"#40485b"},null,8,["icon","onClick"]),e(r,{type:"primary",icon:o(we),onClick:S},{default:l(()=>[...a[10]||(a[10]=[m("添加",-1)])]),_:1},8,["icon"]),e(r,{type:"danger",disabled:!o(I),onClick:a[5]||(a[5]=t=>J("/api/v1/admin/product/delete"))},{default:l(()=>[...a[11]||(a[11]=[m("删除",-1)])]),_:1},8,["disabled"]),c("div",Ue,[e(Z,{class:"ml-4"},{default:l(()=>[e(r,{icon:o(Ve),onClick:o(A)},null,8,["icon","onClick"])]),_:1})])]),c("div",Re,[e(ae,{data:o(u).data,border:"",stripe:"","max-height":"600",style:{width:"100%"},onSelectionChange:o(L)},{default:l(()=>[e(i,{type:"selection",width:"40"}),C.value?P("",!0):(d(),h(i,{key:0,prop:"agent.agent_name",label:"代理商",align:"center","min-width":"150"})),e(i,{prop:"product_name",label:"产品名称",align:"center","min-width":"200"}),e(i,{prop:"product_code",label:"产品编号",align:"center","min-width":"100"}),e(i,{prop:"payment_type.product_name",label:"支付类型",align:"center","min-width":"150"}),e(i,{label:"状态",align:"center","min-width":"90"},{default:l(({row:t})=>[e(ee,{modelValue:t.status,"onUpdate:modelValue":b=>t.status=b,"active-value":1,"inactive-value":0,onChange:b=>o(j)("/api/v1/admin/product/switch",t.id)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(i,{prop:"created_at",label:"创建时间",align:"center","min-width":"150"}),e(i,{label:"操作",align:"center",fixed:"right","min-width":"200"},{default:l(t=>[e(r,{size:"small",onClick:b=>S(t.row)},{default:l(()=>[...a[12]||(a[12]=[m("编辑",-1)])]),_:1},8,["onClick"]),e(r,{size:"small",type:"danger",onClick:b=>H("/api/v1/admin/product/delete",t.row)},{default:l(()=>[...a[13]||(a[13]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])]),c("div",Fe,[c("div",Pe,[e(te,{"current-page":o(u).current_page,"onUpdate:currentPage":a[6]||(a[6]=t=>o(u).current_page=t),"page-size":o(u).page_size,"onUpdate:pageSize":a[7]||(a[7]=t=>o(u).page_size=t),"page-sizes":[10,50,100,200],background:!0,"prev-text":"上一页","next-text":"下一页",layout:"total, sizes, prev, pager, next, jumper",total:o(u).page_total,onSizeChange:o($),onCurrentChange:o(O)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])],64)}}});export{$e as default};
//# sourceMappingURL=home-By7uMXwN.js.map
